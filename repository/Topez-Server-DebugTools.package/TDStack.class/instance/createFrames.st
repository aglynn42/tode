private
createFrames
  | previous stackFrame stackDepth |
  frames := OrderedCollection new.
  self process == nil
    ifTrue: [ ^ frames ].
  previous := nil.
  stackDepth := self process stackDepth.
  1 to: stackDepth do: [ :frameIndex | stackFrame := self stackFrameClass new
      stack: self;
      frameIndex: frameIndex;
      yourself.
    frames add: stackFrame.
    previous ifNotNil: [ previous next: stackFrame ].
    stackFrame previous: previous.
    previous := stackFrame ].
  stackDepth > 0
    ifTrue: [ self trimmed
        ifTrue: [ currentFrame := frames at: 1 ]
        ifFalse: [ currentFrame := self signallerFrame: (frames at: 1).
          (currentFrame ~~ nil and: [ currentFrame frameIndex ~~ 1 ])
            ifTrue: [ currentFrame := currentFrame next ] ] ].
  ^ frames